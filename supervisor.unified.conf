[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid

[program:nginx]
command=nginx -g 'daemon off;'
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/nginx.err.log
stdout_logfile=/var/log/supervisor/nginx.out.log
priority=100

[program:auth-service]
command=uvicorn app.main:app --host 0.0.0.0 --port 8002 --workers 1
directory=/app/auth-service
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/auth-service.err.log
stdout_logfile=/var/log/supervisor/auth-service.out.log
environment=PYTHONPATH="/app/auth-service"
priority=200

[program:core-service]
command=uvicorn app.adapters.api.main:app --host 0.0.0.0 --port 8000 --workers 1
directory=/app/core-service
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/core-service.err.log
stdout_logfile=/var/log/supervisor/core-service.out.log
environment=PYTHONPATH="/app/core-service"
priority=200

[program:sales-service]
command=uvicorn app.adapters.api.main:app --host 0.0.0.0 --port 8001 --workers 1
directory=/app/sales-service
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/sales-service.err.log
stdout_logfile=/var/log/supervisor/sales-service.out.log
environment=PYTHONPATH="/app/sales-service"
priority=200

[program:customer-service]
command=uvicorn app.main:app --host 0.0.0.0 --port 8003 --workers 1
directory=/app/customer-service
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/customer-service.err.log
stdout_logfile=/var/log/supervisor/customer-service.out.log
environment=PYTHONPATH="/app/customer-service"
priority=200

[group:microservices]
programs=auth-service,core-service,sales-service,customer-service
priority=200 